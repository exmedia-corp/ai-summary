# ai-summary

このシェルスクリプトは、Backlogから最近の更新情報を取得し、データを整形してChatGPTにその要約を求めるプロンプトと共に出力します。
要約は、過去一週間に発生した重要な出来事に焦点を当て、各イベントの経緯や結論、プロジェクトやタスクの進捗状況を説明します。

## 機能

- Backlog APIを使用して、最近の活動情報を取得します。
- 指定された日付に基づいて活動をフィルタリングし、デフォルトでは過去一週間のデータを取得します。
- 活動情報を整形し、読み込みやすいJSON形式に変換します。
- ChatGPTに要約を求めるためのプロンプトと共に、整形されたデータを出力します。

## 必要条件

- **curl**: Backlog APIへのリクエストに使用します。
- **jq**: JSONデータの処理とフィルタリングに使用します。

`jq`は以下のコマンドでインストールできます。

```bash
brew install jq
```

## 使用方法

### 1. 環境変数の設定

スクリプトを実行する前に、以下の環境変数を設定する必要があります。
BacklogのAPIキーは、Backlogの個人設定ページから取得できます。

- `BACKLOG_SPACE`: BacklogのスペースID
- `BACKLOG_API_KEY`: BacklogのAPIキー

これらの環境変数は、シェルセッションで次のように設定します。

```bash
export BACKLOG_SPACE="your_backlog_space_id"
export BACKLOG_API_KEY="your_backlog_api_key"
```

### 2. スクリプトの実行

スクリプトはオプションを指定しても、指定しなくても実行できます。以下のコマンドで実行します。

```bash
bash ./backlog.sh [オプション]
```

### オプション

- `-c`: 取得する活動の件数を指定します（デフォルトは100件）。
- `-p`: 特定のプロジェクトキーで活動をフィルタリングします。
- `-d`: 活動の取得開始日を指定します（形式: `YYYY-MM-DD`）。指定がない場合、デフォルトで一週間前の日付になります。

### 実行例

過去一週間の活動をデフォルト件数で取得する:

```bash
bash ./backlog.sh
```

特定のプロジェクトの50件の活動を取得する:

```bash
bash ./backlog.sh -c 50 -p "PROJKEY"
```

特定の日付以降の活動を取得する:

```bash
bash ./backlog.sh -d "2024-12-01"
```

## 出力

スクリプトは、ChatGPTに要約を求めるプロンプトと、フィルタリングされた活動情報をJSON形式で出力します。
プロンプトとJSONデータをChatGPTに入力することで、過去一週間の活動の要約を生成できます。

## 出力例

```
以下のBacklogのログを元に、その一週間で発生した重要な出来事を要約してください。
要約では、時系列ではなく、週単位で発生したイベントをまとめ、各イベントの経緯と結論に至るプロセスを明記してください。
各出来事には必ず該当するBacklogの課題番号を含めてください。
また、プロジェクトやタスクの進捗状況、課題解決のプロセスがどのように進行したかについても説明してください。

[
    {
        "date": "2024-12-01T10:00:00Z",
        "name": "Sam Altman",
        "type": "課題の更新",
        "issueKey": "PROJ-123",
        "summary": "データベーススキーマの更新",
        "comment": "新しいカラムを追加するためにスキーマを更新しました。"
    },
    ...
]
```

## ライセンス

このプロジェクトはMITライセンスの下でライセンスされています。詳細については、[LICENSE](LICENSE)ファイルを参照してください。

